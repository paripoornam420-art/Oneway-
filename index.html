<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bell Taxi Booking</title>

<style>
body{margin:0;font-family:Arial,sans-serif;background:#f5f5f5}
.header{background:#000;color:#fff;padding:15px;text-align:center}
.header span{color:#f5b000}
.tagline{background:#f5b000;text-align:center;padding:10px;font-weight:bold}
.container{padding:15px}
.toggle{display:flex;gap:10px;margin-bottom:15px}
.toggle button{flex:1;padding:12px;border:none;border-radius:25px;font-weight:bold;font-size:16px}
.active{background:#f5b000}
.inactive{background:#eee}
input{width:100%;padding:12px;margin-top:10px;border-radius:25px;border:1px solid #ccc;font-size:16px}
.row{display:flex;gap:10px}
.book-btn{margin-top:18px;background:#f5b000;border:none;padding:15px;width:100%;font-size:18px;border-radius:30px;font-weight:bold}
.note{margin-top:18px;text-align:center;background:#fff;padding:15px;border-radius:20px}
#fareCard{display:none;padding:15px}
.fareBox{background:#fff;padding:15px;border-radius:20px;margin-bottom:10px}
.fareBox button{margin-top:10px;width:100%;padding:10px;border:none;border-radius:20px;background:#f5b000;font-weight:bold}
</style>
</head>

<body>

<div class="header">
  <h1>Bell <span>Taxi</span></h1>
  <p>On Your Location On Need</p>
</div>

<div class="tagline">All India Outstation Cab Service</div>

<div class="container" id="formSection">

  <div class="toggle">
    <button id="onewayBtn" class="active" onclick="setTrip('One Way')">One Way Trip</button>
    <button id="roundBtn" class="inactive" onclick="setTrip('Round Trip')">Round Trip</button>
  </div>

  <input type="text" id="pickup" placeholder="Enter pickup city">
  <input type="text" id="drop" placeholder="Enter destination city">

  <div class="row">
    <input type="text" id="travelDate" placeholder="Select Date" onfocus="this.type='date'">
    <input type="text" id="travelTime" placeholder="Select Time" onfocus="this.type='time'">
  </div>

  <input type="text" id="returnDate" placeholder="Select Return Date" onfocus="this.type='date'" style="display:none">

  <input type="tel" id="mobile" placeholder="Enter mobile number">

  <button class="book-btn" onclick="calculateFare()">Check Price & Book Cab</button>

  <div class="note">
    <h3>No Return Fare</h3>
    <p>One-Way Cab Fare | No Hidden Charges<br>Minimal Advance</p>
  </div>
</div>

<div id="fareCard"></div>

<script>
// TELEGRAM CONFIG
const TELEGRAM_BOT_TOKEN = "8401693275:AAFyrnUnQuaRu0xWbhxkjnwzvjTJsgb6atw";
const TELEGRAM_CHAT_ID = "8358178207";

function sendTelegram(message){
  fetch("https://api.telegram.org/bot" + TELEGRAM_BOT_TOKEN + "/sendMessage",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ chat_id: TELEGRAM_CHAT_ID, text: message })
  });
}

// FARE LOGIC
let tripType="One Way";
const DRIVER_BATA=400;

const RATES={
  "One Way":{minKm:130,Mini:13,Sedan:14,SUV:19,Innova:20},
  "Round Trip":{minKm:250,Mini:12,Sedan:13,SUV:18,Innova:19}
};

let LAST_TOTAL_KM = 0;
let LAST_EST_FARE = 0;

function setTrip(type){
  tripType=type;
  onewayBtn.className=type==="One Way"?"active":"inactive";
  roundBtn.className=type==="Round Trip"?"active":"inactive";
  returnDate.style.display=type==="Round Trip"?"block":"none";
}

function calculateFare(){
  if(!pickup.value||!drop.value||!travelDate.value||!travelTime.value||mobile.value.length<10){
    alert("Please fill all details");
    return;
  }
  if(tripType==="Round Trip" && !returnDate.value){
    alert("Please select return date");
    return;
  }

  new google.maps.DistanceMatrixService().getDistanceMatrix({
    origins:[pickup.value],
    destinations:[drop.value],
    travelMode:"DRIVING"
  },(res,status)=>{
    if(status!=="OK") return alert("Distance error");

    let baseKm=Math.ceil(res.rows[0].elements[0].distance.value/1000);
    let days=1;

    if(tripType==="Round Trip"){
      days=Math.max(1,
        Math.ceil((new Date(returnDate.value)-new Date(travelDate.value))/(1000*60*60*24))
      );
      if(baseKm<RATES["Round Trip"].minKm) baseKm=RATES["Round Trip"].minKm;
    }else{
      if(baseKm<RATES["One Way"].minKm) baseKm=RATES["One Way"].minKm;
    }

    LAST_TOTAL_KM = tripType==="Round Trip" ? baseKm*days : baseKm;

    sendTelegram(
      "ðŸš• Bell Taxi â€“ Fare Checked\n\n"+
      "Trip: "+tripType+"\n"+
      "Pickup: "+pickup.value+"\n"+
      "Drop: "+drop.value+"\n"+
      "Date: "+travelDate.value+"\n"+
      "Time: "+travelTime.value+"\n"+
      "Total KM: "+LAST_TOTAL_KM+"\n"+
      "Status: Fare Checked (Not Booked)"
    );

    showFareCards(baseKm,days);
  });
}

function showFareCards(km,days){
  formSection.style.display="none";
  fareCard.style.display="block";
  fareCard.innerHTML="";

  ["Mini","Sedan","SUV","Innova"].forEach(v=>{
    let totalKm=tripType==="Round Trip"?km*days:km;
    let fare=(totalKm*RATES[tripType][v])+(DRIVER_BATA*days);

    fareCard.innerHTML+=`
      <div class="fareBox">
        <b>${v}</b><br>
        Total KM: ${totalKm}<br>
        Days: ${days}<br>
        Driver Bata: â‚¹${DRIVER_BATA*days}<br>
        <b>Estimated Fare: â‚¹${fare}</b>
        <button onclick="confirmBooking('${v}',${fare},${totalKm})">Book ${v}</button>
      </div>
    `;
  });
}

function generateBookingId(){
  return "BT" + Date.now().toString().slice(-6);
}

function confirmBooking(vehicle,fare,totalKm){
  const bookingId = generateBookingId();
  LAST_EST_FARE = fare;

  sendTelegram(
    "âœ… Bell Taxi â€“ BOOKED\n\n"+
    "Booking ID: "+bookingId+"\n"+
    "Trip: "+tripType+"\n"+
    "Vehicle: "+vehicle+"\n"+
    "Pickup: "+pickup.value+"\n"+
    "Drop: "+drop.value+"\n"+
    "Date: "+travelDate.value+"\n"+
    "Time: "+travelTime.value+"\n"+
    "Total KM: "+totalKm+"\n"+
    "Estimated Fare: â‚¹"+fare+"\n"+
    "Mobile: "+mobile.value
  );

  alert(
    "Booking Confirmed!\n\n"+
    "Booking ID: "+bookingId+"\n"+
    "Total KM: "+totalKm+"\n"+
    "Estimated Fare: â‚¹"+fare
  );
}
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBXnBk1mKSeIF5_UNsLejhqUYFIbJqMXZk&libraries=places&callback=initMap" async defer></script>
<script>
function initMap(){
  new google.maps.places.Autocomplete(pickup);
  new google.maps.places.Autocomplete(drop);
}
</script>

</body>
</html>